<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>AppleOfMyIframe tests</title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js"></script>
  <!-- 
      <script src="http://code.jquery.com/nightlies/jquery-nightly.js"></script>
  -->
  <script src="appleofmyiframe.js"></script>
  <style>
    .stealth {
        position: absolute;
        overflow:hidden;
        width:1px;
        height:1px;
        top:0;
        left:0;
    }
    #tests, #browser, #append-method {
        float:left;
        margin:0 6.85em 2.62em 0;
        padding-bottom:2.62em;
        border-bottom:1px solid #ccc;
    }
    #append-method {
        display:none;
    }
    #stage {
        clear:both;
    }
    iframe {
        display:block;
        margin:1.62em !important;
    }
  </style>
</head>

<body>
  <h1>AppleOfMyIframe</h1>
  
  <div id="tests">
      <h2>Tests</h2>  
      <p>Do the three iframes stay intact throughout?</p>
      <div id="controls">
          <button id="move-iframes">1. Move iframes within the DOM</button>
          <button id="reload-page">2. Reload the page</button>
      </div>
  </div>
  
  <div id="browser">
    <h2>Your browser</h2>
    <textarea class="user-agent" rows="3" cols="42"></textarea>
  </div>
  
  <div id="append-method">
    <h2>Append method</h2>
    <p class="report"></p>
  </div>
  
  <div id="stage">
  </div>
  
  <script>
  // Console logger
  // http://github.com/premasagar/console
  var
  _ = (function(){
	    var
	        win = window,
	        ua = win.navigator.userAgent,
	        console = win.console,
	        opera = win.opera,
	        debug;
	    
        // Doesn't support console API
	    if (!console){
	        // Opera 
	        return (opera && opera.postError) ?
                 function(){
                     var i, argLen, log = opera.postError, args = arguments;
                     argLen = args.length;
		             for (i=0; i < argLen; i++){
			             log(args[i]);
		             }
                 } :
                 function(){};
	    }
	    // Temporary for WebKit, while its console has a bug in calling debug directly or log.apply
	    else if (/webkit/i.test(ua)){	    
            return function(){
                var i, argLen, args = arguments;
                argLen = args.length;
		        for (i=0; i < argLen; i++){
			        console.log(args[i]);
		        }
            };
        }
        else {
	        debug = console.debug;
	        return debug ? // FF Firebug
		        debug :
		        function(){
			        var i, argLen, log = console.log, args = arguments;
			        if (log){ // WebKit
				        if (typeof log.apply === 'function'){
					        log.apply(console, args);
				        }
				        else { // IE8
					        argLen = args.length;
					        for (i=0; i < argLen; i++){
						        log(args[i]);
					        }
				        }
			        }
		        };
		}
    })();
    
    // ****************************************
  
  
    $('#browser .user-agent')
    .val(window.navigator.userAgent)
    .focus(function(){
        var ta = this;
        window.setTimeout(function(){
            ta.select();
        });
    });

    // Determine appendMethod
    var stealth = $('<div></div>')
        .addClass('stealth')
        .appendTo('body');
    var iHidden = $.iframe('<p>blah</p>', {attr:{id:'iHidden'}})
        .one('restore', function(ev, appendMethod){
            $('#append-method')
                .show()
                .find('.report')
                    .text(appendMethod);
            stealth.remove();
            delete stealth;
            delete iHidden;
        })
        .load(function(){
            this.appendTo(stealth);
        })
        .appendTo(stealth);
  
    $('#move-iframes')
        .click(function(){
            var div = $('<div style="background-color:red; padding:1em;"></div>').appendTo('body');
            i1.appendTo(div);
            i2.appendTo(div);
            i3.appendTo(div);
        });

    $('#reload-page')
        .click(function(){
            window.location.href = window.location.href;
        });

     // External src iframe
     var i1 = $.iframe('http://google.co.uk')
        .attr('id', 'i1')
        .appendTo('#stage');

     
     // Injected iframes
     var i2 = $.iframe('<p>test</p>')
        .attr('id', 'i2')
        .appendTo('#stage');
     
     var i3 = $.iframe('<p>hi there</p>', {attr:{frameBorder:1}, css:{backgroundColor:'blue'}})
        .attr('id', 'i3')
        .appendTo('#stage');
	    
	 
	/*
    // Example usage
    // Return a new iframe element, in an enhanced jQuery wrapper
    $.iframe();
    
    // Grab the iframe's body element, in a jQuery wrapper
    $.iframe().body();
    
    // Inject content into the iframe body. The following all achieve the same.
    $.iframe('<p>blah</p>');
    $.iframe().body('<p>blah</p>');
    $.iframe().body().append('<p>blah</p>');
    
    // The above examples are not visible on the page, because they do not add the iframe to the DOM. This example does:
    $.iframe('<p>blah</p>')
      .appendTo('body')
      .append('<p>stuff</p>');
    
    // Grab an existing element in the DOM and inject it into a new iframe; then replace the element with that iframe
		$('#example-host-content').intoIframe();
    
    // Resize iframe element to fit its body contents
    $.iframe('<p>blah2</p>').matchSize()
      .appendTo('body');
	*/
  </script>
</body>
</html>
